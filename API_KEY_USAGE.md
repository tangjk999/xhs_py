# DeepSeek API密钥管理功能使用说明

## 功能概述

本系统已集成DeepSeek API密钥管理功能，用户可以在网页界面中输入、保存和管理API密钥，系统会自动保存到本地文件并在下次启动时自动加载。

## 主要功能

### 1. API密钥输入界面
- 在网页顶部新增了"DeepSeek API密钥设置"区域
- 提供密码输入框，支持显示/隐藏密钥
- 包含保存和加载按钮

### 2. 自动保存和加载
- 用户输入的API密钥会自动保存到本地`api_key.json`文件
- 下次打开网页时会自动加载已保存的API密钥
- 密钥以JSON格式安全存储在项目根目录

### 3. 实时更新
- 分析器会在每次分析时使用最新的API密钥
- 支持动态更新API密钥，无需重启应用

## 使用方法

### 1. 设置API密钥
1. 打开网页应用（默认地址：http://localhost:5001）
2. 在页面顶部的"DeepSeek API密钥设置"区域
3. 在输入框中输入您的DeepSeek API密钥
4. 点击"保存密钥"按钮

### 2. 验证密钥
- 点击"加载密钥"按钮可以验证保存的密钥
- 密钥会显示在输入框中（默认隐藏状态）

### 3. 使用分析功能
- 设置API密钥后，即可使用AI分析功能
- 系统会自动使用保存的API密钥进行DeepSeek API调用

## 技术实现

### 后端API
- `POST /api/save-api-key` - 保存API密钥
- `GET /api/load-api-key` - 加载API密钥

### 文件存储
- 密钥保存在项目根目录的`api_key.json`文件中
- 文件格式：
```json
{
  "deepseek_api_key": "your-api-key-here"
}
```

### 安全特性
- API密钥以密码形式显示，支持显示/隐藏切换
- 密钥仅保存在本地，不会上传到服务器
- 使用JSON格式安全存储

## 注意事项

1. **安全性**：API密钥仅保存在本地文件中，请确保文件安全
2. **备份**：建议定期备份`api_key.json`文件
3. **权限**：确保应用有读写项目根目录的权限
4. **格式**：API密钥应以`sk-`开头

## 故障排除

### 常见问题
1. **密钥保存失败**：检查文件权限和磁盘空间
2. **密钥加载失败**：确认`api_key.json`文件存在且格式正确
3. **分析失败**：验证API密钥是否有效且有足够配额

### 调试方法
- 查看浏览器控制台的错误信息
- 检查Flask应用的日志输出
- 验证API密钥文件的内容和格式

## 更新日志

- **v1.0.0** - 初始版本，支持基本的API密钥保存和加载功能
- 支持网页界面输入和管理
- 支持自动保存和加载
- 集成到分析流程中